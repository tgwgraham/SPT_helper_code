Thomas's SPT helper functions
